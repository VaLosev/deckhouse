# Администрирование

## Термины и определения

тут список терминов и определений админского админа
| Термины и определения | Описание|
|:--- |:---|
| Термин | Описание термина |

 ## Доступ

### *Подключение*

   * Установка
   * Настройка
   * Подключение узлов
   * Kubernetes Dashboard? (https://deckhouse.ru.test.flant.com/documentation/v1/modules/500-dashboard/)

### *Аутентификация*

https://deckhouse.ru.test.flant.com/documentation/v1/modules/150-user-authn/

   * **Создание пользователя и пользовательская аутентификация**
   (Проверка подлинности пользователей и предоставление им доступа к ресурсам. Обычно это включает создание и управление пользователями, ролями и авторизациями в кластере с использованием стандартных механизмов аутентификации, таких как LDAP, OAuth, SAML или x509 сертификаты).
   * **Авторизация ресурсов**
   Предоставление пользователям прав на доступ к ресурсам в кластере - подам, сервисам через RBAC и вебхук.
   * **Шифрование**
   Шифрование секретов: пароли, токены и ключи API. Всякие Public Key Infrastructure.
   * **Контроль доступа RBAC**
   Управление доступом к ресурсам на основе предопределенных ролей, назначаемых пользователям.
   * **Конфигурации модуля аутентификации**
   * **Аутентификация на основе токенов**

(Способ аутентификации запросов API заключается в использовании *bearer* заголовка, содержащего действительный токен JWT для учетной записи службы. 
Как и в случае с пользователями, разные учетные записи служб будут иметь разные уровни доступа. 
Учетная запись службы имеет токен.Этот токен хранится как Secret и может быть прочитан как `secret`. Этот токен необходимо использовать для аутентификации стороннего приложения на сервере API.

Примерный сценарий:

1. Cоздайте учетную запись службы ДКП с именем *serviceaccount*.

2. Определите разрешение на аутентификацию для всего кластера (например, для get, list, watch pods, services, namespaces, deployments, jobs) с помощью *CluserRole*. *ClusterRole* будет присвоено имя учетной записи службы через *ClusterRoleBinding*. Токен внутри учетной записи службы может использоваться для аутентификации/авторизации сервера API. 
Можно вызывать API-интерфейсы сервера DropApp API с помощью этого токена (с *bearer* заголовком) и получить доступ к ресурсам (например, pods, services, namespaces и т.д.).)

      
### *Авторизация*

https://deckhouse.ru.test.flant.com/documentation/v1/modules/140-user-authz/

Убираем создание пользователя из Авторизации, переносим в Аутентификацию
   * **Роли и права доступа**
   * **Ограничения доступа**

## Установка и сопровождение

   ### *Установка платформы*

  https://deckhouse.ru.test.flant.com/documentation/v1/installing/

   * **Подготовка инфраструктуры**
   * **Подготовка конфигурации**
   * **Ресурсы установки**
   * **Установка ДКП**

### *Интеграция платформы с инфраструктурой*(мало контента)

Оин из сценариев сюда (https://deckhouse.ru.test.flant.com/documentation/v1/modules/402-ingress-nginx/)

   * **Настройка взаимодействия между компонентами платформы и существующими системами**
   * **Разработка механизмов обмена данными между платформой и другими системами**
   * **Обеспечение совместимости платформы с различными типами оборудования и программного обеспечения**
   * **Создание инструментов для импорта данных из других источников и экспорта данных в другие системы**
   * **Интеграция с системами управления доступом и авторизацией пользователей**
   * **Настройка интеграции с внешними сервисами и API**

### *Настройка платформы*

https://deckhouse.ru.test.flant.com/documentation/v1/installing/configuration.html

* Установка платформы (ссылка на раздел установки)
Сценарий - загрузить образ платформы и развернуть  на серверах.
* Настройка инфраструктуры
Сценарий - настроить инфраструктуру (серверы, сети, пользователи и другие ресурсы).
* Настройка контроллера репликации?
* Управление доступом и авторизация (ссылка на рздел создания пользователей, RBAC)
* Интеграция с другими системами (ссылка на раздел, где системы управления версиями, системы мониторинга и т.д.)
* Мониторинг (ссылка на раздел мониторинга)

### *Обновление платформы*

* **Окна и каналы обновлений**

https://deckhouse.ru.test.flant.com/documentation/v1/deckhouse-release-channels.html

### *Высокая надежность и доступность*

https://deckhouse.ru.test.flant.com/documentation/v1/kubernetes.html

https://deckhouse.ru.test.flant.com/documentation/v1/modules/460-log-shipper/

* **Going to production** (нужны тестовые сценарии)
- Подготовка инфраструктуры
Например, создание необходимых серверов, сетей, пользователей...
- Развертывание ДКП
Образ Deckhouse или собственный образ для развертывания платформы на пользовательской инфраструктуре.
- Настройка ДКП
Изменение конфигурации, добавление новых компонентов и т. д.
- Тестирование и отладка
- Внедрение в производство
- Непрерывное обновление и обслуживание

### *Управление ресурсами платформы*

https://deckhouse.ru.test.flant.com/documentation/v1/installing/# (хранилища)

  * Управление вычислительными ресурсами: Можно создавать новые ресурсы, изменять их параметры и удалять ненужные.
  * Управление хранилищами данных: Deckhouse предоставляет инструменты для работы с различными типами хранилищ, такими как локальные диски, облачные хранилища и базы данных. Можно создавать новые хранилища, монтировать их к контейнерам и управлять доступом к ним.
  * Управление сетевыми ресурсами: настраивать сетевые интерфейсы, правила межсетевого экранирования и виртуальные частные сети (VPN). Также доступ к различным сервисам и приложениям в сети.
  * Мониторинг ресурсов: о встроенных инструментах для мониторинга ресурсов - нагрузка на процессор, использование памяти и сетевого трафика + можно отслеживать состояние системы и фиксить возможные проблемы.

### *Масштабирование платформы*

https://deckhouse.ru.test.flant.com/documentation/v1/modules/001-priority-class/configuration.html#

### *Безопасность платформы*

https://deckhouse.ru.test.flant.com/documentation/v1/modules/160-multitenancy-manager/
https://deckhouse.ru.test.flant.com/documentation/v1/modules/015-admission-policy-engine/

Также в безопасность:
  * изоляция контейнеров;
  * выявление уязвимостей в образах контейнеров;
  * проверка корректности конфигурации контейнеров;
  * контроль целостности контейнеров и их образов;
  * регистрация событий безопасности.

* **Дока по портам**

https://deckhouse.ru.test.flant.com/documentation/v1/search.html?query=порты

(сценариев нет)

* **Дока по папкам для антивируса**

По антивирусам сценариев нет (нужно включить все российские).

### *Мониторинг платформы*

https://deckhouse.ru.test.flant.com/documentation/v1/modules/300-prometheus/ (и все разделы ниже)

  * **Системы мониторинга - Prometheus & Grafana**
  * **Мониторинг пользовательского приложения**
  * **Мониторинг сети**
  * **Мониторинг кластера**
  * **Мониторинг control plane**
  * **Расширенный мониторинг**

### *Журналирование платформы*

https://deckhouse.ru.test.flant.com/documentation/v1/modules/460-log-shipper/#

  * **Логи** - сбор, хранение и анализ лог-файлов 

## Контроль и управление доступом

### *Разделение ресурсов платформы между пользователями*

Безопасность и конфиденциальность данных для каждого пользователя?

https://deckhouse.ru.test.flant.com/documentation/v1/search.html?query=пользователи (покопаться тут можно)


## Пожелания коллег к доке админа: 

Товарищи, всем привет в данном чате! я ознакомился со всем тредом, но пока не очень понимаю, в каком виде мы тут хотим иметь доку (и где мы хотим её видеть)Как понимаю, было бы неплохо иметь как минимум описания мест, где у нас прописываются данные о реджистри (источник истины как понимаю, это секрет d8-system/deckhouse-registry , также данные у нас прописываются в /etc/containerd/config.toml, который синкается из /etc/containerd/deckhouse.toml)Но как будто бы у нас сейчас где-либо в документации таких мест нет, и вообще это подходит вероятно для "руководства администратора", который планируется у нас в будущем?

From a thread in tech-deckhouse | Yesterday at 6:44 PM | View reply

dmitrii.kovalkov

Да, я понимаю, просто команда helm -n d8-system get manifest deckhouse даёт уже отрендеренные (с подставленными значениями), а в секрете именно темплейт
