---
title: Изменение версии Kubernetes в Deckhouse Kubernetes Platform
permalink: ru/update/kubernetes/update-kubernetes/
lang: ru
---

{% alert level="info" %}
Модули `node-manager` и `control-plane-manager` обеспечивают механизмы обновления версии Kubernetes. Убедитесь, что они включены.
{% endalert %}

В Deckhouse Kubernetes Platform (DKP) настроено автоматическое изменение версии Kubernetes на узлах в кластере. Обновление выполняется безопасно и для single-master, и для multi-master-кластеров. На работу приложений в кластере обновление не влияет и может выполняться без выделения окна для регламентных работ.

Группы узлов обновляются паралелльно. Узлы кластера внутри каждой группы узлов обновляются последовательно:  
- **при переходе к новой версии** обновление происходит последовательными этапами, по одной минорной версии, например от 1.24 к 1.25, от 1.25 к 1.26, от 1.26 к 1.27. На каждом этапе сначала обновляется версия управляющего слоя, затем происходит обновление `kubelet` на узлах кластера.
- **при переходе к предыдущей версии** успех гарантируется только на одну версию вниз от максимальной минорной версии управляющего слоя, когда-либо использовавшейся в кластере:
  - происходит понижение версии `kubelet` на узлах кластера.
  - происходит понижение версии компонентов управляющего слоя.

Текущая версия Kubernetes в кластере определяется по версиям управляющего слоя и узлов кластера. 

Механизм управляется одним параметром `kebrnetesVersion` с возможными значениями:
* `Automatic` – DKP обновляет версию Kubernetes на узлах в соответсвии с версией Kubernetes в релизе. Посмотреть поддерживающиеся версии можно на [странице](https://deckhouse.io/documentation/v1/supported_versions.html).
* выбор желаемой версии, например `1.27` – DKP попробует привести версию узлов в кластере к указанной версии. Если версия устареет, то ее придется менять вручную.

Чтобы изменить версию Kubernetes:

1. Выполните:

   ```
   kubectl -n d8-system exec -ti deploy/deckhouse --deckhouse-controller edit cluster-configuration
   ```

1. Измените параметр `kubernetesVersion`, выбрав `kubernetesVersion: Automatic` или указав желаемую версию.
1. Сохраните изменения.
1. Отслеживайте ход обновления с помощью команды `kubectl get no`.  
    Когда в выводе команды у каждого узла кластера в колонке `VERSION` появится нужная версия, обновление можно считать завершенны.
